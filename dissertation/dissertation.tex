% This one will format for two-sided binding (ie left and right pages have mirror margins; blank pages inserted where needed):
% \documentclass[a4paper,12pt]{ociamthesis}
% This one will format for one-sided binding (ie left margin > right margin; no extra blank pages):
%\documentclass[a4paper]{ociamthesis}
% This one will format for PDF output (ie equal margins, no extra blank pages):
\documentclass[a4paper,nobind]{ociamthesis} 
\pdfminorversion=7



%%%%% SELECT YOUR DRAFT OPTIONS
% Three options going on here; use in any combination.  But remember to turn the first two off before
% generating a PDF to send to the printer!

% This adds a "DRAFT" footer to every normal page.  (The first page of each chapter is not a "normal" page.)
% \fancyfoot[C]{\emph{DRAFT Printed on \today}}  

% This highlights (in blue) corrections marked with (for words) \mccorrect{blah} or (for whole
% paragraphs) \begin{mccorrection} . . . \end{mccorrection}.  This can be useful for sending a PDF of
% your corrected thesis to your examiners for review.  Turn it off, and the blue disappears.
\correctionstrue

\usepackage{subfigure}
\usepackage{listings}
\usepackage{amssymb}
\usepackage{longtable}
\usepackage{array}


%%%%% BIBLIOGRAPHY SETUP
% The science-type option: numerical in-text citation with references in order of appearance.
\usepackage[style=numeric-comp, sorting=none, backend=biber, doi=false, isbn=false, language=british]{biblatex}
\newcommand*{\bibtitle}{References}

% This makes the bibliography left-aligned (not 'justified') and slightly smaller font.
\renewcommand*{\bibfont}{\raggedright\small}

% Change this to the name of your .bib file (usually exported from a citation manager like Zotero or EndNote).
\addbibresource{references.bib}
% graphics path
\graphicspath{ {./figures/} }


% Uncomment this if you want equation numbers per section (2.3.12), instead of per chapter (2.18):
%\numberwithin{equation}{subsection}



%%%%% THESIS / TITLE PAGE INFORMATION
% Everybody needs to complete the following:
\title{Predicting Prime Editing Outcome with Machine Learning}
\author{Peiheng Lu}
\college{Wolfson College}

% Master's candidates who require the alternate title page (with candidate number and word count)
% must also un-comment and complete the following three lines:
\masterssubmissiontrue
\candidateno{1592800}
\wordcount{17,263}

% Uncomment the following line if your degree also includes exams (eg most masters):
%\renewcommand{\submittedtext}{Submitted in partial completion of the}
% Your full degree name.  (But remember that DPhils aren't "in" anything.  They're just DPhils.)
\degree{MSc Advanced Computer Science}
% Term and year of submission, or date if your board requires (eg most masters)
\degreedate{Michaelmas 2024}


%%%%% YOUR OWN PERSONAL MACROS
% This is a good place to dump your own LaTeX macros as they come up.

% To make text superscripts shortcuts
\renewcommand{\th}{\textsuperscript{th}} % ex: I won 4\th place
\newcommand{\nd}{\textsuperscript{nd}}
\renewcommand{\st}{\textsuperscript{st}}
\newcommand{\rd}{\textsuperscript{rd}}

%%%%% THE ACTUAL DOCUMENT STARTS HERE
\begin{document}

%%%%% CHOOSE YOUR LINE SPACING HERE
% This is the official option.  Use it for your submission copy and library copy:
\setlength{\textbaselineskip}{22pt plus2pt}
% This is closer spacing (about 1.5-spaced) that you might prefer for your personal copies:
%\setlength{\textbaselineskip}{18pt plus2pt minus1pt}

% You can set the spacing here for the roman-numbered pages (acknowledgements, table of contents, etc.)
\setlength{\frontmatterbaselineskip}{18pt plus2pt minus1pt}

% Leave this line alone; it gets things started for the real document.
\setlength{\baselineskip}{\textbaselineskip}

%%%%% CHOOSE YOUR SECTION NUMBERING DEPTH HERE
% You have two choices.  First, how far down are sections numbered?  (Below that, they're named but
% don't get numbers.)  Second, what level of section appears in the table of contents?  These don't have
% to match: you can have numbered sections that don't show up in the ToC, or unnumbered sections that
% do.  Throughout, 0 = chapter; 1 = section; 2 = subsection; 3 = subsubsection, 4 = paragraph...

% The level that gets a number:
\setcounter{secnumdepth}{2}
% The level that shows up in the ToC:
\setcounter{tocdepth}{2}


%%%%% ABSTRACT SEPARATE
% This is used to create the separate, one-page abstract that you are required to hand into the Exam
% Schools.  You can comment it out to generate a PDF for printing or whatnot.
% \begin{abstractseparate}

% \end{abstractseparate}


% JEM: Pages are roman numbered from here, though page numbers are invisible until ToC.  This is in
% keeping with most typesetting conventions.
\begin{romanpages}

% JEM: By default, this template uses the traditional Oxford "Belt Crest". Un-comment the following
% line to use the newer, "Blue Square" logo:
\renewcommand{\crest}{{\includegraphics[width=4.2cm, height=4.2cm]{figures/newlogo.pdf}}}

% Title page is created here
\maketitle

%%%%% DEDICATION -- If you'd like one, un-comment the following.
%\begin{dedication}
%This thesis is dedicated to\\
%someone\\
%for some special reason\\
%\end{dedication}

%%%%% ACKNOWLEDGEMENTS -- Nothing to do here except comment out if you don't want it.
\begin{acknowledgements}

    I would like to express my heartfelt gratitude to my supervisor, and soon to be Dr. (censored for anonymity, the full version will be shared once the mark is released). Your invaluable guidance and unwavering support have been crucial throughout this project, particularly as I navigated the uncharted waters of deep learning and gene editing. Undertaking this project without prior deep learning experience was indeed daunting, but your patience and encouragement made the journey significantly more manageable. Regardless of the project's outcome, I have gained immense knowledge and am truly thankful for the opportunity to work with you.

    I also wish to extend my thanks to my friends, whose support helped me get through the challenging phases of this project. Your companionship made the experience far less grueling. The daily routines of cooking together and our conversations have provided much-needed relaxation after long workdays, and I am grateful for the strong friendships we have forged over these past months.
    
    Lastly, as I reach what might be the conclusion of my student life, I want to thank my family for their unwavering support and encouragement. They have borne the significant financial and emotional burdens of supporting my education abroad without ever mentioning it over the past five years. They have always been my greatest cheerleaders, desiring nothing in return but my happiness and success. I am truly grateful for their unconditional love and support.

\end{acknowledgements}

%%%%% ABSTRACT -- Nothing to do here except comment out if you don't want it.
\begin{abstract}

    Prime editing is one of the most recent advancements in gene editing, offering significantly more versatility than the CRISPR-Cas9 and base editor systems. However, its effectiveness is often constrained by low efficiency, particularly when unoptimized guide RNAs are used. To address this issue, various computational tools have been developed for in silico optimization of prime editing guide RNAs, achieving varying levels of success.

    This study expanded the toolkit for computational guide optimization by developing several new machine learning models, which demonstrated superior or comparable performance to existing tools across multiple datasets.

    The project began by assembling a benchmarking dataset of prime editing outcomes from the literature, incorporating a total of 23 datasets derived from two different studies.

    Several ensemble models were then developed using classical ensemble techniques, such as weighted averaging, bagging, and AdaBoost. These ensembles integrated existing models like PRIDICT and DeepPrime, with other traditional machine learning algorithms, including XGBoost and ridge regression, and achieved competitive performance on the benchmarking datasets.

    Additionally, the transformer architecture, known for its success in sequence-to-sequence tasks, was also implemented. However, it did not achieve the same level of performance as the ensemble models on the primary datasets. This discrepancy may be attributed to the fundamental differences between prime editing and base editing efficiency prediction tasks, where transformers have previously excelled.

    The top-performing model - bagging ensemble - was presented as a web application, enabling users without deep learning expertise to input their desired target edits and receive recommendations for pegRNA designs.
\end{abstract}

%%%%% MINI TABLES
% This lays the groundwork for per-chapter, mini tables of contents.  Comment the following line
% (and remove \minitoc from the chapter files) if you don't want this.  Un-comment either of the
% next two lines if you want a per-chapter list of figures or tables.
\dominitoc % include a mini table of contents
%\dominilof  % include a mini list of figures
%\dominilot  % include a mini list of tables

% This aligns the bottom of the text of each page.  It generally makes things look better.
\flushbottom

% This is where the whole-document ToC appears:
% This is where the whole-document ToC appears:
\tableofcontents

\listoffigures
\mtcaddchapter
% \mtcaddchapter is needed when adding a non-chapter (but chapter-like) entity to avoid confusing minitoc

% Uncomment to generate a list of tables:
%\listoftables
%	\mtcaddchapter

% repository information 
\chapter*{Source Code and Data Availability}
All source code for this project is available on GitHub at:

\url{https://github.com/1592800-ox/ox-dissertation.git}. 

The repository is of substantial size ($\sim 16$GB) due to the large number of trained models and datasets, so be sure to have enough disk space before cloning!

The data used in this project is available in the `models/data' directory of the repository. However, due to the size limit of GitHub, all non-standardized datasets need to be regenerated using the scripts in the `models/data/std' directory.

%%%%% LIST OF ABBREVIATIONS
% This example includes a list of abbreviations.
\include{text/abbreviations}
\end{romanpages}

\input{text/introduction.tex}
\input{text/method.tex}
\input{text/benchmarking.tex}
\input{text/discussion.tex}

\startappendices
% Add or remove any appendices you'd like here:


%%%%% REFERENCES


{\renewcommand*\MakeUppercase[1]{#1}%

% \input{text/appendix-models.tex}
\input{text/appendix.tex}


\printbibliography[heading=bibintoc,title={\bibtitle}]}


\end{document}